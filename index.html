<script>
let history = JSON.parse(localStorage.getItem("financeHistory")) || [];

function analyze() {

  const month = document.getElementById("month").value;
  const withdraw = Number(document.getElementById("withdraw").value);
  const grocery = Number(document.getElementById("grocery").value);
  const travel = Number(document.getElementById("travel").value);
  const other = Number(document.getElementById("other").value);
  const mood = document.getElementById("mood").value;

  const totalExpense = grocery + travel + other;
  const today = new Date().toLocaleDateString();

  // SAVE TODAY DATA
  history.push({
    date: today,
    month,
    withdraw,
    expense: totalExpense,
    mood
  });

  localStorage.setItem("financeHistory", JSON.stringify(history));

  // CALCULATE TOTALS
  let totalWithdraw = history.reduce((a,b)=>a+b.withdraw,0);
  let totalExpenseAll = history.reduce((a,b)=>a+b.expense,0);
  let netBalance = totalWithdraw - totalExpenseAll;

  let messages = "";

  messages += `<div class='alert green'>ğŸ’¾ Data Saved Successfully</div>`;
  messages += `<div class='alert'>ğŸ“Š Total Withdraw: â‚¹${totalWithdraw}</div>`;
  messages += `<div class='alert'>ğŸ’¸ Total Expense: â‚¹${totalExpenseAll}</div>`;
  messages += `<div class='alert'>ğŸ§® Net Survival Balance: â‚¹${netBalance}</div>`;

  // FEBâ€“MARCH LOGIC
  if (month === "February" || month === "March") {
    messages += "<div class='alert yellow'>ğŸŸ¡ SURVIVAL MODE ACTIVE</div>";

    if (totalExpense > 500) {
      messages += "<div class='alert red'>âš ï¸ Aaj limit cross hui. Kal â‚¹400 se upar mat jaana.</div>";
    }

    if (mood !== "ok") {
      messages += "<div class='alert red'>ğŸ§  Mood unstable. NEXT DAY NO TRADING.</div>";
    }
  }

  // AUGUST LOGIC
  if (month === "August+") {
    messages += "<div class='alert green'>ğŸŸ¢ STABILITY MODE â€“ Start SIPs & Gold</div>";
  }

  document.getElementById("result").innerHTML = messages;
}
</script>
