<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Survival Finance Log</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  background:#0b1020;
  color:#fff;
  font-family:system-ui, -apple-system, BlinkMacSystemFont;
  margin:0;
  padding:20px;
}
.card{
  background:#121a35;
  border-radius:14px;
  padding:18px;
  margin-bottom:20px;
}
h2{margin:0 0 12px}
input,select{
  width:100%;
  padding:10px;
  margin-bottom:10px;
  border-radius:8px;
  border:none;
}
button{
  width:100%;
  padding:14px;
  font-size:16px;
  border:none;
  border-radius:10px;
  background:#22c55e;
  color:#000;
  font-weight:700;
  cursor:pointer;
}
.row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.badge{
  padding:10px;
  border-radius:8px;
  margin-top:8px;
}
.green{background:#16a34a}
.red{background:#dc2626}
.yellow{background:#ca8a04}
canvas{max-height:260px}
</style>
</head>

<body>

<div class="card">
<h2>ðŸ“… Daily Entry</h2>

<input type="date" id="date">
<select id="month">
  <option>January</option><option>February</option><option>March</option>
  <option>April</option><option>May</option><option>June</option>
  <option>July</option><option>August</option><option>September</option>
  <option>October</option><option>November</option><option>December</option>
</select>

<input type="number" id="salary" placeholder="Salary received today">
<input type="number" id="withdraw" placeholder="Withdraw">

<div class="row">
  <input type="number" id="grocery" placeholder="Grocery">
  <input type="number" id="travel" placeholder="Travel">
</div>

<input type="number" id="other" placeholder="Other">

<select id="mood">
  <option>ok</option>
  <option>tired</option>
  <option>stressed</option>
</select>

<button onclick="analyzeSaveGuide()">Analyze â€¢ Save â€¢ Guide</button>
</div>

<div class="card">
<h2>ðŸ“Œ Today Summary</h2>
<div id="todaySummary"></div>
<div id="guideBox"></div>
</div>

<div class="card">
<h2>ðŸ“… Current Month Summary</h2>
<div id="monthSummary"></div>
</div>

<div class="card">
<h2>ðŸ“Š Today Visual</h2>
<canvas id="todayPie"></canvas>
<canvas id="todayBar"></canvas>
</div>

<div class="card">
<h2>ðŸ“Š Current Month Visual</h2>
<canvas id="monthPie"></canvas>
<canvas id="monthBar"></canvas>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxFcD-thZfQdrrjZfiOh5Y0z7ZwONJLb7lfn_-LmCw5bB2pOyax5riGBV--pz_YhQX9EQ/exec";

let charts=[];

function analyzeSaveGuide(){
  const data={
    date:date.value,
    month:month.value,
    salary:+salary.value||0,
    withdraw:+withdraw.value||0,
    grocery:+grocery.value||0,
    travel:+travel.value||0,
    other:+other.value||0,
    mood:mood.value
  };

  fetch(SCRIPT_URL,{
    method:"POST",
    body:JSON.stringify(data)
  }).then(r=>r.json()).then(res=>{
    render(res);
  });
}

function render(res){
  const t=res.today;
  const m=res.month;

  todaySummary.innerHTML=
    `Withdraw â‚¹${t.withdraw} | Expense â‚¹${t.expense} | Balance â‚¹${t.balance}`;

  let guide="";
  let cls="green";
  if(t.expense>t.withdraw){
    guide="âš  Expense high. Tomorrow limit â‚¹"+Math.floor(t.withdraw*0.4);
    cls="red";
  }else{
    guide="âœ… Trading allowed (discipline)";
  }
  guideBox.innerHTML=`<div class="badge ${cls}">${guide}</div>
  <div class="badge yellow">ðŸŽ¯ Rule: Survival > Profit</div>`;

  monthSummary.innerHTML=
    `Withdraw â‚¹${m.withdraw} | Expense â‚¹${m.expense} | Balance â‚¹${m.balance}`;

  charts.forEach(c=>c.destroy());
  charts=[];

  charts.push(new Chart(todayPie,{
    type:"doughnut",
    data:{
      labels:["Grocery","Travel","Other"],
      datasets:[{data:[t.grocery,t.travel,t.other],
      backgroundColor:["#22c55e","#3b82f6","#f97316"]}]
    }
  }));

  charts.push(new Chart(todayBar,{
    type:"bar",
    data:{
      labels:["Withdraw","Expense"],
      datasets:[{data:[t.withdraw,t.expense],
      backgroundColor:["#16a34a","#dc2626"]}]
    },
    options:{plugins:{legend:{display:false}}}
  }));

  charts.push(new Chart(monthPie,{
    type:"doughnut",
    data:{
      labels:["Grocery","Travel","Other"],
      datasets:[{data:[m.grocery,m.travel,m.other],
      backgroundColor:["#22c55e","#3b82f6","#f97316"]}]
    }
  }));

  charts.push(new Chart(monthBar,{
    type:"bar",
    data:{
      labels:["Withdraw","Expense"],
      datasets:[{data:[m.withdraw,m.expense],
      backgroundColor:["#16a34a","#dc2626"]}]
    },
    options:{plugins:{legend:{display:false}}}
  }));
}
</script>

</body>
</html>
